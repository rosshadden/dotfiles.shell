#!/usr/bin/env bash

export DOTS="${DOTS:-$HOME/dotfiles}"

source "$DOTS/lib/dots/functions.sh"

while getopts ":vV" opt; do
	case "$opt" in
		v|V) cat "$DOTS/VERSION"; exit ;;
		:) error "Option '-$OPTARG' requires an argument" ;;
		*) error "Invalid option: -$OPTARG" ;;
	esac
done
shift "$((OPTIND-1))"

action="${1:-status}"
shift

case "$action" in
	i|install) action=install ;;
	s|status) action=status ;;
	v|version) $0 -v; exit ;;
esac

actionFile="$DOTS/lib/dots/$action.sh"
if [[ -f "$actionFile" ]]; then
	$actionFile $*
else
	error "Invalid action: $action"
fi
