#!/usr/bin/env bash

export DOTS="${DOTS:-$HOME/dotfiles}"

source "$DOTS/lib/dots/functions.sh"

spec=":vV"
while getopts $spec opt; do
	case "$opt" in
		v | V) $0 version; exit ;;
		:) error "Option '-$OPTARG' requires an argument" ;;
		*) error "Invalid option: -$OPTARG" ;;
	esac
done
shift "$((OPTIND-1))"

action="${1:-status}"

case "$action" in
	i | install) action=install ;;
	s | status) action=status ;;
	v | version) action=version ;;
esac

actionFile="$DOTS/lib/dots/$action.sh"
if [[ -f "$actionFile" ]]; then
	shift
	$actionFile $*
else
	error "Invalid action: $action"
fi
